<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bluff Masters</title>
<link rel="icon" href="blufffavicon.png" />
<style>
  :root{
    --bg1:#061226;
    --bg2:#081b31;
    --card:#0e2336;
    --muted:#9fb7bf;
    --accent:#2ecc71;
    --gold:#ffd36d;
    --danger:#ff6b6b;
  }
  html,body{height:100%;margin:0;font-family:Inter,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:radial-gradient(circle at 10% 10%,var(--bg1),var(--bg2) 60%);color:#e6eef3;-webkit-font-smoothing:antialiased;}
  .wrap{max-width:1100px;margin:22px auto;padding:20px;}
  header{display:flex;align-items:center;gap:18px;margin-bottom:18px}
  .logo{width:62px;height:62px;border-radius:12px;background:linear-gradient(135deg,#ff6b6b,#ffd36d);display:flex;align-items:center;justify-content:center;font-weight:800;color:#07111a;box-shadow:0 8px 28px rgba(0,0,0,0.6)}
  h1{margin:0;font-size:28px}
  .subtitle{color:var(--muted);font-size:13px;margin-top:6px}
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02)); border-radius:14px;padding:16px;box-shadow: 8px 8px 32px rgba(2,6,12,0.6), -6px -6px 18px rgba(255,255,255,0.01);border:1px solid rgba(255,255,255,0.03);}
  .section-title{font-size:28px;margin:6px 0 12px}
  .small-muted{font-size:0.9rem;color:var(--muted)}
  .active-wrap{margin-top:12px}
  #activeList{display:flex;flex-direction:column;gap:12px}
  .series-card{display:flex;justify-content:space-between;align-items:center;gap:12px;padding:14px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(0,0,0,0.02));border:1px solid rgba(255,255,255,0.02)}
  .series-card .left{flex:1}
  .series-card .title{font-weight:700;font-size:1.05rem}
  .series-card .sub{color:var(--muted);font-size:0.9rem;margin-top:6px}
  .right-controls{display:flex;align-items:center;gap:10px;padding:8px;border-radius:10px;background:linear-gradient(90deg, rgba(255,208,96,0.02), rgba(255,208,96,0.005));border:1px solid rgba(255,208,96,0.04)}
  .score{font-weight:800;font-size:1.05rem;margin-right:6px;color:#e9f7f1}
  .neu-btn{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));border-radius:10px;border:1px solid rgba(255,255,255,0.04);padding:10px 14px;color:#e6eef3;font-weight:700;cursor:pointer}
  .neu-btn.secondary{background:linear-gradient(180deg, rgba(0,0,0,0.06), rgba(255,255,255,0.01));color:#cfe3e3}
</style>
</head>
<body>
<div class="wrap">
<header>
  <div class="logo">28</div>
  <div>
    <h1>Bluff Masters</h1>
    <div class="subtitle">Track multiple active series, shared stats & celebrations</div>
  </div>
  <div style="flex:1"></div>
  <button class="neu-btn" onclick="goHome()">üè† Home</button>
</header>

<section id="homeSection">
  <div class="card">
    <div class="section-title">Active Series</div>
    <div id="noActive" class="small-muted">No Active Series ‚Äî start a new one.</div>
    <div id="seriesCount" style="margin-bottom:12px">Series Active: 0</div>
    <button class="neu-btn" onclick="startNewSeries()">‚ûï New Series</button>
    <div id="activeList" style="margin-top:12px"></div>
  </div>
</section>

<div id="modalContainer"></div>

<script type="module">
const SECRET_KEY="zachariahrenji";
const STORAGE_KEY="bluff_tracker_v2";
const TEAM_LIST=["Bibin & Zach","Bimal & Annu","Bibin & Annu","Zach & Daddy","Bibin & Bimal","Zach & Rikku","Bibin & Daddy"];
let gameData={games:[]};

try{
  const raw=localStorage.getItem(STORAGE_KEY);
  if(raw) gameData=JSON.parse(raw);
}catch{}

function saveLocal(){localStorage.setItem(STORAGE_KEY,JSON.stringify(gameData));}
function uid(){return "series_"+Date.now();}

function computeSeries(){
  const map={};
  gameData.games.forEach(g=>{
    if(!map[g.seriesId]) map[g.seriesId]={teams:g.seriesTeams,wins:{}};
    if(g.winner){
      map[g.seriesId].wins[g.winner]=(map[g.seriesId].wins[g.winner]||0)+1;
    }
  });
  return map;
}

function renderHomeActiveList(){
  const list=document.getElementById("activeList");
  list.innerHTML="";
  const series=computeSeries();
  const keys=Object.keys(series);
  document.getElementById("seriesCount").textContent="Series Active: "+keys.length;
  document.getElementById("noActive").style.display=keys.length?"none":"block";

  keys.forEach(id=>{
    const s=series[id];
    const [a,b]=s.teams;
    const sa=s.wins[a]||0, sb=s.wins[b]||0;

    const div=document.createElement("div");
    div.className="series-card";
    div.innerHTML=`
      <div class="left">
        <div class="title">${a} vs ${b}</div>
      </div>
      <div class="right-controls">
        <div class="score">${sa} ‚Äî ${sb}</div>
        <button class="neu-btn" onclick="addGame('${id}','${a}','${b}')">‚ûï Add</button>
        <button class="neu-btn secondary" onclick="editTeams('${id}')">‚úèÔ∏è Edit</button>
      </div>`;
    list.appendChild(div);
  });
}

window.startNewSeries=function(){
  const a=prompt("Team A")||TEAM_LIST[0];
  const b=prompt("Team B")||TEAM_LIST[1];
  if(a===b) return alert("Teams must differ");
  gameData.games.push({seriesId:uid(),seriesTeams:[a,b]});
  saveLocal();renderHomeActiveList();
};

window.addGame=function(id,a,b){
  const w=confirm(`${a} won?`) ? a : b;
  const l=w===a?b:a;
  gameData.games.push({seriesId:id,seriesTeams:[a,b],winner:w,loser:l});
  saveLocal();renderHomeActiveList();
};

window.editTeams=function(id){
  const pw=prompt("Password");
  if(pw!==SECRET_KEY) return;
  const g=gameData.games.find(x=>x.seriesId===id);
  const val=prompt("Edit teams",g.seriesTeams.join(","));
  if(!val) return;
  const [a,b]=val.split(",").map(x=>x.trim());
  gameData.games.forEach(x=>{
    if(x.seriesId===id){
      x.seriesTeams=[a,b];
      if(x.winner){
        x.winner=x.winner===g.seriesTeams[0]?a:b;
        x.loser=x.loser===g.seriesTeams[0]?a:b;
      }
    }
  });
  saveLocal();renderHomeActiveList();
};

window.goHome=function(){};

renderHomeActiveList();
</script>
</body>
</html>
